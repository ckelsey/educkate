!function(t){t.directive("walkthru",["$timeout","$sce",function(t,e){return{restrict:"E",scope:{steps:"=steps",index:"=?index",blur:"@blur"},template:'<div class=c-walkthru__wrapper ng-if=steps2Do.steps.length><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'top\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'right\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'bottom\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'left\')"></div><div class=c-walkthru__box ng-style="getBlockerStyle(\'message\')"><div class=c-walkthru__box-inner><div ng-bind-html=makeSafe(text)></div><div class=c-walkthru__buttons><button ng-click=doPrevious() class=c-walkthru__button__previous><i class="fa fa-arrow-left"></i></button> <button ng-click=doNext() class=c-walkthru__button__next><i class="fa fa-arrow-right"></i></button></div><button ng-click=doDone() class=c-walkthru__button__done><i class="fa fa-close"></i></button></div></div></div>',link:function(o,n,s){function i(t){t=t||window.event,t.preventDefault&&t.preventDefault(),t.returnValue=!1}function l(t){return u[t.keyCode]?(i(t),!1):void 0}function p(){window.onwheel=i,window.onmousewheel=document.onmousewheel=i,window.ontouchmove=i,document.onkeydown=l}function c(){window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null}var u={37:1,38:1,39:1,40:1};o.index=o.index?o.index:0,o.text=null,o.blockStyles={top:{top:"0px",left:"0px",width:"100%",height:"50%"},bottom:{top:"50%",left:"0px",width:"100%",height:"50%"},left:{top:"0px",left:"0px",width:"0px",height:"0px"},right:{top:"0px",left:"0px",width:"0px",height:"0px"},message:{top:"0px",left:"0px"}};var r=function(t){if(t.parentNode&&"BODY"!==t.parentNode.tagName){var e=angular.element(t.parentNode);e.addClass("walkthru_item_parent"),r(e[0])}},d=function(e,n){t(function(){window.scrollTo(e.offsetLeft-14,e.offsetTop-14);var t=e.getBoundingClientRect(),s=n.getBoundingClientRect();o.blockStyles={top:{top:"0px",left:"0px",width:"100%",height:t.top+"px"},bottom:{top:t.bottom+"px",left:"0px",width:"100%",height:window.innerHeight-t.bottom+"px"},left:{top:t.top+"px",left:"0px",width:t.left+"px",height:t.bottom-t.top+"px"},right:{top:t.top+"px",left:t.left+t.width+"px",width:window.innerWidth-(t.left+t.width)+"px",height:t.bottom-t.top+"px"},message:{top:"0px",left:"0px"}},parseInt(o.blockStyles.top.height)>parseInt(o.blockStyles.bottom.height)?o.blockStyles.message.top=parseInt(o.blockStyles.top.height)-s.height-7<0?"0px":parseInt(o.blockStyles.top.height)-s.height-7+"px":s.height+7>parseInt(o.blockStyles.bottom.height)?o.blockStyles.message.top=parseInt(o.blockStyles.bottom.top)-(s.height-parseInt(o.blockStyles.bottom.height))+"px":o.blockStyles.message.top=parseInt(o.blockStyles.bottom.top)+7+"px",o.blockStyles.message.left=(window.innerWidth-s.width)/2+"px"})},h=function(t){var e=t.getBoundingClientRect();o.blockStyles={top:{top:"0px",left:"0px",width:"100%",height:"50%"},bottom:{top:"50%",left:"0px",width:"100%",height:"50%"},left:{top:"0px",left:"0px",width:"0px",height:"0px"},right:{top:"0px",left:"0px",width:"0px",height:"0px"},message:{top:(window.innerHeight-e.height)/2+"px",left:(window.innerWidth-e.width)/2+"px"}}},a=function(){o.steps2Do.steps[o.index].hasOwnProperty("fn")&&"function"==typeof o.steps2Do.steps[o.index].fn&&o.steps2Do.steps[o.index].fn()},x=function(){var t=n[0].querySelector(".c-walkthru__button__next"),e=n[0].querySelector(".c-walkthru__button__previous");o.steps2Do.steps[o.index+1]?t.className="c-walkthru__button__next":t.className="c-walkthru__button__next disabled",o.steps2Do.steps[o.index-1]?e.className="c-walkthru__button__previous":e.className="c-walkthru__button__previous disabled"};o.makeSafe=function(t){return e.trustAsHtml(t)},o.doNext=function(){o.index=o.steps2Do.steps[o.index+1]?o.index+1:0,o.index&&(o.steps2Do.hasOwnProperty("onNext")&&"function"==typeof o.steps2Do.onNext&&o.steps2Do.onNext(),o.doStep())},o.doPrevious=function(){o.index=o.steps2Do.steps[o.index-1]?o.index-1:o.steps2Do.steps.length-1,o.steps2Do.hasOwnProperty("onPrevious")&&"function"==typeof o.steps2Do.onPrevious&&o.steps2Do.onPrevious(),o.doStep()},o.doDone=function(){t(function(){var t=angular.element(document.body);t.removeClass("c-walkthru__body"),o.steps2Do.hasOwnProperty("onDone")&&"function"==typeof o.steps2Do.onDone&&o.steps2Do.onDone(),c(),o.index=0,o.steps2Do=null,n.removeClass("active"),o.steps=null})},o.getBlockerStyle=function(t){return o.blockStyles[t]};var f=null;o.doStep=function(){if(t.cancel(f),o.steps2Do){var e=angular.element(document.querySelectorAll(".walkthru_item_parent"));e.removeClass("walkthru_item_parent"),e=angular.element(document.querySelectorAll(".walkthru_item")),e.removeClass("walkthru_item"),r(n[0]);var s=o.steps2Do.steps[o.index].element?document.querySelector(o.steps2Do.steps[o.index].element):null,i=n[0].querySelector(".c-walkthru__box");if((o.steps2Do.steps[o.index].element&&s||!o.steps2Do.steps[o.index].element)&&i)if(o.text=o.steps2Do.steps[o.index].text,a(),x(),o.steps2Do.steps[o.index].element){var l=21,p=function(){var t=s.getBoundingClientRect();!t.height&&l?setTimeout(function(){l--,p()},100):($el=angular.element(s),$el.addClass("walkthru_item"),r(s),d(s,i))};p()}else h(i);else f=t(function(){o.doStep()},50)}},o.run=function(e){o.steps&&o.steps.steps&&o.steps.steps.length&&t(function(){p(),o.steps2Do=angular.copy(o.steps),o.index=o.index?o.index:0,n.addClass("active"),o.doStep()})},o.init=function(){o.steps&&o.steps.steps&&o.steps.steps.length&&t(function(){var t=angular.element(document.body);t.addClass("c-walkthru__body"),o.steps.hasOwnProperty("onInitialize")&&"function"==typeof o.steps.onInitialize&&o.steps.onInitialize(),o.run()})},o.steps&&o.init();var w=null,g=function(){clearTimeout(w),o.steps&&(w=setTimeout(function(){o.run()},20))};window.addEventListener("resize",g,!0),o.$watchCollection(function(){return o.steps},function(t,e){t!==e&&t&&t.hasOwnProperty("steps")&&t.steps.length&&o.init()})}}}])}(angular.module("walKthru",[]));
//# sourceMappingURL=walkthru.min.js.map