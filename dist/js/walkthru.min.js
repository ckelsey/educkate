!function(e){e.directive("walkthru",["$timeout","$sce","$compile",function(e,t,o){return{restrict:"E",scope:{steps:"=steps",index:"=?index",blur:"@blur",paddingTop:"@paddingTop",paddingLeft:"@paddingLeft"},template:'<div class=c-walkthru__wrapper ng-if=steps2Do.steps.length><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'top\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'right\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'bottom\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'left\')"></div><div class=c-walkthru__box ng-style="getBlockerStyle(\'message\')"><div class=c-walkthru__box-inner><div ng-bind-html=makeSafe(text)></div><div class=c-walkthru__buttons><button ng-click=doPrevious() class=c-walkthru__button__previous><i class="fa fa-arrow-left"></i></button> <button ng-click=doNext() class=c-walkthru__button__next><i class="fa fa-arrow-right"></i></button></div><button ng-click=doDone() class=c-walkthru__button__done><i class="fa fa-close"></i></button></div></div></div>',link:function(o,n,s){o.proxyIndex=o.index?angular.copy(o.index):0,o.steps2Do=null,o.text=null,o.defaultBlockStyles={top:{top:"0px",left:"0px",width:"100%",height:"50%"},bottom:{top:"50%",left:"0px",width:"100%",height:"50%"},left:{top:"0px",left:"0px",width:"0px",height:"0px"},right:{top:"0px",left:"0px",width:"0px",height:"0px"},message:{top:"0px",left:"0px"}},o.blockStyles=angular.copy(o.defaultBlockStyles);var l={37:1,38:1,39:1,40:1},i=function(e){e.preventDefault(),e.stopPropagation(),e.returnValue=!1},r=function(e){return l[e.keyCode]?(i(e),!1):void 0},p=function(){document.body.addEventListener("mousewheel",i,!0),document.body.addEventListener("wheel",i,!0),document.body.addEventListener("touchmove",i,!0),document.body.addEventListener("keydown",r,!0)},a=function(){document.body.removeEventListener("mousewheel",i,!0),document.body.removeEventListener("wheel",i,!0),document.body.removeEventListener("touchmove",i,!0),document.body.removeEventListener("keydown",r,!0)},d=function(e){if(e.parentNode&&"BODY"!==e.parentNode.tagName){var t=angular.element(e.parentNode);t.addClass("walkthru_item_parent"),d(t[0])}},u=function(e){return e.parentNode&&"BODY"!==e.parentNode.tagName?e.parentNode.scrollHeight>e.parentNode.offsetHeight?e.parentNode:u(e.parentNode):e.parentNode},c=function(e){window.scrollTo(e.offsetLeft-o.paddingLeft,e.offsetTop-o.paddingTop);var t=function(e,n){var s=e.getBoundingClientRect().top,l=e.getBoundingClientRect().bottom,i=s>=0&&l<=window.innerHeight;i||(n=u(n),n&&(n.scrollTop=e.offsetTop-o.paddingTop,n.scrollLeft=e.offsetLeft-o.paddingLeft,t(e,n)))};t(e,e)},h=function(t,n){e(function(){if(o.blockStyles=angular.copy(o.defaultBlockStyles),t){c(t);var e=t.getBoundingClientRect(),s=n.getBoundingClientRect();o.blockStyles.top.height=e.top+"px",o.blockStyles.bottom.top=e.bottom+"px",o.blockStyles.bottom.height=window.innerHeight-e.bottom+"px",o.blockStyles.left.top=e.top+"px",o.blockStyles.left.width=e.left+"px",o.blockStyles.left.height=e.bottom-e.top+"px",o.blockStyles.right.top=e.top+"px",o.blockStyles.right.left=e.left+e.width+"px",o.blockStyles.right.width=window.innerWidth-(e.left+e.width)+"px",o.blockStyles.right.height=e.bottom-e.top+"px",parseInt(o.blockStyles.top.height)>parseInt(o.blockStyles.bottom.height)?o.blockStyles.message.top=parseInt(o.blockStyles.top.height)-s.height-7<0?"0px":parseInt(o.blockStyles.top.height)-s.height-7+"px":s.height+7>parseInt(o.blockStyles.bottom.height)?o.blockStyles.message.top=parseInt(o.blockStyles.bottom.top)-(s.height-parseInt(o.blockStyles.bottom.height))+"px":o.blockStyles.message.top=parseInt(o.blockStyles.bottom.top)+7+"px",o.blockStyles.message.left=(window.innerWidth-s.width)/2+"px"}else{var s=n.getBoundingClientRect();o.blockStyles.message.top=(window.innerHeight-s.height)/2+"px",o.blockStyles.message.left=(window.innerWidth-s.width)/2+"px"}})},g=function(){var e=n[0].querySelector(".c-walkthru__button__next"),t=n[0].querySelector(".c-walkthru__button__previous");o.steps2Do.steps[o.proxyIndex+1]?e.className="c-walkthru__button__next":e.className="c-walkthru__button__next disabled",o.steps2Do.steps[o.proxyIndex-1]?t.className="c-walkthru__button__previous":t.className="c-walkthru__button__previous disabled"},f=function(){var e=angular.element(document.querySelectorAll(".walkthru_item_parent"));e.removeClass("walkthru_item_parent"),e=angular.element(document.querySelectorAll(".walkthru_item")),e.removeClass("walkthru_item")};o.makeSafe=function(e){return t.trustAsHtml(e)},o.doNext=function(){o.proxyIndex=o.steps2Do.steps[o.proxyIndex+1]?o.proxyIndex+1:0,o.steps2Do.hasOwnProperty("onNext")&&"function"==typeof o.steps2Do.onNext&&o.steps2Do.onNext(),x=40,o.doStep()},o.doPrevious=function(){o.proxyIndex=o.steps2Do.steps[o.proxyIndex-1]?o.proxyIndex-1:0,o.steps2Do.hasOwnProperty("onPrevious")&&"function"==typeof o.steps2Do.onPrevious&&o.steps2Do.onPrevious(),x=40,o.doStep()},o.doDone=function(){e(function(){o.steps2Do.hasOwnProperty("onDone")&&"function"==typeof o.steps2Do.onDone&&o.steps2Do.onDone(),a(),o.steps2Do=null,angular.element(document.body).removeClass("c-walkthru__body"),angular.element(document.body).removeClass("c-walkthru__body_blur"),f(),n.removeClass("active"),o.steps=null})},o.getBlockerStyle=function(e){return o.blockStyles[e]};var y=null,x=40;o.doStep=function(){if(e.cancel(y),o.steps2Do){f(),o.blur!==!0&&"true"!==o.blur||d(n[0]);var t=o.steps2Do.steps[o.proxyIndex].element?document.querySelector(o.steps2Do.steps[o.proxyIndex].element):null,s=n[0].querySelector(".c-walkthru__box");if((o.steps2Do.steps[o.proxyIndex].element&&t||!o.steps2Do.steps[o.proxyIndex].element)&&s)if(o.steps2Do.steps[o.proxyIndex].hasOwnProperty("fn")&&"function"==typeof o.steps2Do.steps[o.proxyIndex].fn&&o.steps2Do.steps[o.proxyIndex].fn(),o.text=o.steps2Do.steps[o.proxyIndex].text,g(),o.steps2Do.steps[o.proxyIndex].element){var l=11,i=function(){var e=t.getBoundingClientRect();!e.height&&l?setTimeout(function(){l--,i()},100):(angular.element(t).addClass("walkthru_item"),o.blur!==!0&&"true"!==o.blur||d(t),h(t,s))};i()}else h(null,s);else x&&(y=e(function(){x--,o.doStep()},50))}},o.run=function(t){o.steps&&o.steps.steps&&o.steps.steps.length&&e(function(){p(),o.steps2Do=angular.copy(o.steps),n.addClass("active"),o.doStep()})},o.init=function(){o.steps&&o.steps.steps&&o.steps.steps.length&&e(function(){x=40,o.paddingTop=void 0===o.paddingTop?14:o.paddingTop,o.paddingLeft=void 0===o.paddingLeft?14:o.paddingLeft,o.blur!==!0&&"true"!==o.blur||angular.element(document.body).addClass("c-walkthru__body_blur"),angular.element(document.body).addClass("c-walkthru__body"),o.proxyIndex=o.index?angular.copy(o.index):0,o.steps.hasOwnProperty("onInitialize")&&"function"==typeof o.steps.onInitialize&&o.steps.onInitialize(),o.run()})},o.steps&&o.init();var b=null,m=function(){clearTimeout(b),o.steps&&(b=setTimeout(function(){o.run()},20))};window.addEventListener("resize",m,!0),o.$watchCollection(function(){return o.steps},function(e,t){e!==t&&e&&e.hasOwnProperty("steps")&&e.steps.length&&o.init()}),o.$watchCollection(function(){return o.index},function(e,t){e!==t&&(o.proxyIndex=parseInt(o.index)?angular.copy(parseInt(o.index)):0,o.run())})}}}])}(angular.module("walKthru",[]));
//# sourceMappingURL=walkthru.min.js.map