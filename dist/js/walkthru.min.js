!function(t){t.directive("walkthru",["$timeout","$sce","$compile",function(t,e,o){return{restrict:"E",scope:{steps:"=steps",index:"=?index",blur:"@blur"},template:'<div class=c-walkthru__wrapper ng-if=steps2Do.steps.length><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'top\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'right\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'bottom\')"></div><div class=c-walkthru__blocker ng-style="getBlockerStyle(\'left\')"></div><div class=c-walkthru__box ng-style="getBlockerStyle(\'message\')"><div class=c-walkthru__box-inner><div ng-bind-html=makeSafe(text)></div><div class=c-walkthru__buttons><button ng-click=doPrevious() class=c-walkthru__button__previous><i class="fa fa-arrow-left"></i></button> <button ng-click=doNext() class=c-walkthru__button__next><i class="fa fa-arrow-right"></i></button></div><button ng-click=doDone() class=c-walkthru__button__done><i class="fa fa-close"></i></button></div></div></div>',link:function(o,n,s){o.proxyIndex=o.index?angular.copy(o.index):0,o.steps2Do=null,o.text=null,o.defaultBlockStyles={top:{top:"0px",left:"0px",width:"100%",height:"50%"},bottom:{top:"50%",left:"0px",width:"100%",height:"50%"},left:{top:"0px",left:"0px",width:"0px",height:"0px"},right:{top:"0px",left:"0px",width:"0px",height:"0px"},message:{top:"0px",left:"0px"}},o.blockStyles=angular.copy(o.defaultBlockStyles);var l={37:1,38:1,39:1,40:1},r=function(t){t.preventDefault(),t.stopPropagation(),t.returnValue=!1},i=function(t){return l[t.keyCode]?(r(t),!1):void 0},p=function(){window.addEventListener("mousewheel",r,!0),window.addEventListener("wheel",r,!0),window.addEventListener("touchmove",r,!0),window.addEventListener("keydown",i,!0)},a=function(){window.removeEventListener("mousewheel",r,!0),window.removeEventListener("wheel",r,!0),window.removeEventListener("touchmove",r,!0),window.removeEventListener("keydown",i,!0)},u=function(t){if(t.parentNode&&"BODY"!==t.parentNode.tagName){var e=angular.element(t.parentNode);e.addClass("walkthru_item_parent"),u(e[0])}},c=function(e,n){t(function(){if(o.blockStyles=angular.copy(o.defaultBlockStyles),e){window.scrollTo(e.offsetLeft-14,e.offsetTop-14);var t=e.getBoundingClientRect(),s=n.getBoundingClientRect();o.blockStyles.top.height=t.top+"px",o.blockStyles.bottom.top=t.bottom+"px",o.blockStyles.bottom.height=window.innerHeight-t.bottom+"px",o.blockStyles.left.top=t.top+"px",o.blockStyles.left.width=t.left+"px",o.blockStyles.left.height=t.bottom-t.top+"px",o.blockStyles.right.top=t.top+"px",o.blockStyles.right.left=t.left+t.width+"px",o.blockStyles.right.width=window.innerWidth-(t.left+t.width)+"px",o.blockStyles.right.height=t.bottom-t.top+"px",parseInt(o.blockStyles.top.height)>parseInt(o.blockStyles.bottom.height)?o.blockStyles.message.top=parseInt(o.blockStyles.top.height)-s.height-7<0?"0px":parseInt(o.blockStyles.top.height)-s.height-7+"px":s.height+7>parseInt(o.blockStyles.bottom.height)?o.blockStyles.message.top=parseInt(o.blockStyles.bottom.top)-(s.height-parseInt(o.blockStyles.bottom.height))+"px":o.blockStyles.message.top=parseInt(o.blockStyles.bottom.top)+7+"px",o.blockStyles.message.left=(window.innerWidth-s.width)/2+"px"}else{var s=n.getBoundingClientRect();o.blockStyles.message.top=(window.innerHeight-s.height)/2+"px",o.blockStyles.message.left=(window.innerWidth-s.width)/2+"px"}})},d=function(){var t=n[0].querySelector(".c-walkthru__button__next"),e=n[0].querySelector(".c-walkthru__button__previous");o.steps2Do.steps[o.proxyIndex+1]?t.className="c-walkthru__button__next":t.className="c-walkthru__button__next disabled",o.steps2Do.steps[o.proxyIndex-1]?e.className="c-walkthru__button__previous":e.className="c-walkthru__button__previous disabled"},h=function(){var t=angular.element(document.querySelectorAll(".walkthru_item_parent"));t.removeClass("walkthru_item_parent"),t=angular.element(document.querySelectorAll(".walkthru_item")),t.removeClass("walkthru_item")};o.makeSafe=function(t){return e.trustAsHtml(t)},o.doNext=function(){o.proxyIndex=o.steps2Do.steps[o.proxyIndex+1]?o.proxyIndex+1:0,o.steps2Do.hasOwnProperty("onNext")&&"function"==typeof o.steps2Do.onNext&&o.steps2Do.onNext(),x=40,o.doStep()},o.doPrevious=function(){o.proxyIndex=o.steps2Do.steps[o.proxyIndex-1]?o.proxyIndex-1:0,o.steps2Do.hasOwnProperty("onPrevious")&&"function"==typeof o.steps2Do.onPrevious&&o.steps2Do.onPrevious(),x=40,o.doStep()},o.doDone=function(){t(function(){o.steps2Do.hasOwnProperty("onDone")&&"function"==typeof o.steps2Do.onDone&&o.steps2Do.onDone(),a(),o.steps2Do=null,angular.element(document.body).removeClass("c-walkthru__body"),angular.element(document.body).removeClass("c-walkthru__body_blur"),h(),n.removeClass("active"),o.steps=null})},o.getBlockerStyle=function(t){return o.blockStyles[t]};var y=null,x=40;o.doStep=function(){if(t.cancel(y),o.steps2Do){h(),o.blur!==!0&&"true"!==o.blur||u(n[0]);var e=o.steps2Do.steps[o.proxyIndex].element?document.querySelector(o.steps2Do.steps[o.proxyIndex].element):null,s=n[0].querySelector(".c-walkthru__box");if((o.steps2Do.steps[o.proxyIndex].element&&e||!o.steps2Do.steps[o.proxyIndex].element)&&s)if(o.steps2Do.steps[o.proxyIndex].hasOwnProperty("fn")&&"function"==typeof o.steps2Do.steps[o.proxyIndex].fn&&o.steps2Do.steps[o.proxyIndex].fn(),o.text=o.steps2Do.steps[o.proxyIndex].text,d(),o.steps2Do.steps[o.proxyIndex].element){var l=11,r=function(){var t=e.getBoundingClientRect();!t.height&&l?setTimeout(function(){l--,r()},100):(angular.element(e).addClass("walkthru_item"),o.blur!==!0&&"true"!==o.blur||u(e),c(e,s))};r()}else c(null,s);else x&&(y=t(function(){x--,o.doStep()},50))}},o.run=function(e){o.steps&&o.steps.steps&&o.steps.steps.length&&t(function(){p(),o.steps2Do=angular.copy(o.steps),n.addClass("active"),o.doStep()})},o.init=function(){o.steps&&o.steps.steps&&o.steps.steps.length&&t(function(){x=40,o.blur!==!0&&"true"!==o.blur||angular.element(document.body).addClass("c-walkthru__body_blur"),angular.element(document.body).addClass("c-walkthru__body"),o.proxyIndex=o.index?angular.copy(o.index):0,o.steps.hasOwnProperty("onInitialize")&&"function"==typeof o.steps.onInitialize&&o.steps.onInitialize(),o.run()})},o.steps&&o.init();var w=null,f=function(){clearTimeout(w),o.steps&&(w=setTimeout(function(){o.run()},20))};window.addEventListener("resize",f,!0),o.$watchCollection(function(){return o.steps},function(t,e){t!==e&&t&&t.hasOwnProperty("steps")&&t.steps.length&&o.init()}),o.$watchCollection(function(){return o.index},function(t,e){t!==e&&(console.log(t),o.proxyIndex=t?angular.copy(t):0,o.run())})}}}])}(angular.module("walKthru",[]));
//# sourceMappingURL=walkthru.min.js.map