!function(e){e.directive("educkate",["$timeout",function(e){return{restrict:"E",scope:{steps:"=steps",index:"=?index",blur:"@blur"},template:'<div class=c-educkate__wrapper ng-if=steps2Do.steps.length><div class=c-educkate__blocker ng-style="getBlockerStyle(\'top\')"></div><div class=c-educkate__blocker ng-style="getBlockerStyle(\'right\')"></div><div class=c-educkate__blocker ng-style="getBlockerStyle(\'bottom\')"></div><div class=c-educkate__blocker ng-style="getBlockerStyle(\'left\')"></div><div class=c-educkate__box ng-style="getBlockerStyle(\'message\')"><div ng-bind=text></div><div><button ng-click=doPrevious() class=c-educkate__button__previous><i class="fa fa-arrow-left"></i></button> <button ng-click=doNext() class=c-educkate__button__next><i class="fa fa-arrow-right"></i></button> <button ng-click=doDone() class=c-educkate__button__done><i class="fa fa-close"></i></button></div></div></div>',link:function(t,n,o){function l(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function i(e){return u[e.keyCode]?(l(e),!1):void 0}function s(){window.onwheel=l,window.onmousewheel=document.onmousewheel=l,window.ontouchmove=l,document.onkeydown=i}function r(){window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null}var u={37:1,38:1,39:1,40:1};t.index=t.index?t.index:0,t.text=null,t.blockStyles={top:{top:"0px",left:"0px",width:"100%",height:"0px"},bottom:{top:"0px",left:"0px",width:"100%",height:"0px"},left:{top:"0px",left:"0px",width:"0px",height:"0px"},right:{top:"0px",left:"0px",width:"0px",height:"0px"},message:{top:"0px",left:"0px"}},t.doNext=function(){t.index=t.steps2Do.steps[t.index+1]?t.index+1:0,t.index&&(t.steps2Do.hasOwnProperty("onNext")&&"function"==typeof t.steps2Do.onNext&&t.steps2Do.onNext(),t.doStep())},t.doPrevious=function(){t.index=t.steps2Do.steps[t.index-1]?t.index-1:t.steps2Do.steps.length-1,t.steps2Do.hasOwnProperty("onPrevious")&&"function"==typeof t.steps2Do.onPrevious&&t.steps2Do.onPrevious(),t.doStep()},t.doDone=function(){e(function(){t.steps2Do.hasOwnProperty("onDone")&&"function"==typeof t.steps2Do.onDone&&t.steps2Do.onDone(),r(),t.index=0,t.steps2Do=null,n.removeClass("active"),t.steps=null})},t.getBlockerStyle=function(e){return t.blockStyles[e]},t.doStep=function(){t.text=t.steps2Do.steps[t.index].text;var o=document.querySelector(t.steps2Do.steps[t.index].element),l=n[0].querySelector(".c-educkate__box");if(o&&l){t.steps2Do.steps[t.index].hasOwnProperty("fn")&&"function"==typeof t.steps2Do.steps[t.index].fn&&t.steps2Do.steps[t.index].fn();var i=n[0].querySelector(".c-educkate__button__next"),s=n[0].querySelector(".c-educkate__button__previous");t.steps2Do.steps[t.index+1]?i.className="c-educkate__button__next":i.className="c-educkate__button__next disabled",t.steps2Do.steps[t.index-1]?s.className="c-educkate__button__previous":s.className="c-educkate__button__previous disabled";var r=o.getBoundingClientRect(),u=n[0].querySelector(".c-educkate__box").getBoundingClientRect(),d=r.right>window.innerWidth-window.scrollX?r.left:0,a=o.offsetTop<window.innerHeight?o.offsetTop-u.height:o.offsetTop+r.height;window.scrollTo(d,a),r=o.getBoundingClientRect(),u=n[0].querySelector(".c-educkate__box").getBoundingClientRect(),t.blockStyles={top:{top:"0px",left:"0px",width:"100%",height:r.top+"px"},bottom:{top:r.bottom+"px",left:"0px",width:"100%",height:window.innerHeight-r.bottom+"px"},left:{top:r.top+"px",left:"0px",width:r.left+"px",height:r.bottom-r.top+"px"},right:{top:r.top+"px",left:r.left+r.width+"px",width:window.innerWidth-(r.left+r.width)+"px",height:r.bottom-r.top+"px"},message:{top:"0px",left:"0px"}},parseInt(t.blockStyles.top.height)>parseInt(t.blockStyles.bottom.height)?t.blockStyles.message.top=parseInt(t.blockStyles.top.height)-u.height-7<0?"0px":parseInt(t.blockStyles.top.height)-u.height-7+"px":u.height+7>parseInt(t.blockStyles.bottom.height)?t.blockStyles.message.top=parseInt(t.blockStyles.bottom.top)-(u.height-parseInt(t.blockStyles.bottom.height))+"px":t.blockStyles.message.top=parseInt(t.blockStyles.bottom.top)+7+"px",t.blockStyles.message.left=(window.innerWidth-u.width)/2+"px"}else e(function(){t.doStep()},200)},t.run=function(o){e(function(){s(),t.steps2Do=angular.copy(t.steps),t.index=t.index?t.index:0,n.addClass("active"),t.doStep()})},t.init=function(){e(function(){t.steps.hasOwnProperty("initialize")&&"function"==typeof t.steps.initialize&&t.steps.initialize(),t.run()})},t.steps&&t.init();var d=null,a=function(){clearTimeout(d),t.steps&&(d=setTimeout(function(){t.run()},20))};window.addEventListener("resize",a,!0),t.$watchCollection(function(){return t.steps},function(e,n){e!==n&&e&&e.hasOwnProperty("steps")&&e.steps.length&&t.init()})}}}])}(angular.module("eduCKate",[])),function(e){e.service("eduCKateService",["$q","$timeout","$location",function(e,t,n){var o=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",o=0;e>o;o++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},l={active:!1,_wrapper:null,_styles:null,_box:null,_top:null,_right:null,_bottom:null,_left:null,_text:null,_doneBtn:null,_prevBtn:null,_nextBtn:null,doneFunc:null,index:0,steps:null,dom_it:function(){var t=e.defer();l._wrapper=document.getElementById("walkthru_wrapper"),l._wrapper&&l._wrapper.parentNode.removeChild(l._wrapper);var n='<div id="walkthru_wrapper"><div id="walkthru_styles"></div><div id="walkthru_blockout_top"></div><div id="walkthru_blockout_right"></div><div id="walkthru_blockout_bottom"></div><div id="walkthru_blockout_left"></div><div id="walkthru_inner"><div id="walkthru_box"><div id="walkthru_box_inner"><div id="walkthru_box_text"></div><div id="walkthru_box_buttons"><button id="walkthru_box_done">done</button><button id="walkthru_box_prev">previous</button><button id="walkthru_box_next">next</button></div></div></div></div></div>';return angular.element(document.body).append(n),l._wrapper=angular.element(document.getElementById("walkthru_wrapper")),l._styles=angular.element(document.getElementById("walkthru_styles")),l._box=angular.element(document.getElementById("walkthru_inner")),l._top=angular.element(document.getElementById("walkthru_blockout_top")),l._right=angular.element(document.getElementById("walkthru_blockout_right")),l._bottom=angular.element(document.getElementById("walkthru_blockout_bottom")),l._left=angular.element(document.getElementById("walkthru_blockout_left")),l._text=angular.element(document.getElementById("walkthru_box_text")),l._doneBtn=angular.element(document.getElementById("walkthru_box_done")),l._prevBtn=angular.element(document.getElementById("walkthru_box_prev")),l._nextBtn=angular.element(document.getElementById("walkthru_box_next")),t.resolve(!0),t.promise},cycleParents:function(e){if(e.parentNode&&"BODY"!==e.parentNode.tagName){var t=angular.element(e.parentNode);t.addClass("walkthru_item_parent"),l.cycleParents(t[0])}},makeStyles:function(e,t){var n="<style>#"+e.attr("id")+"{z-index:99999;",o=e.css("position");o&&"static"!=o||(n+="position:relative;"),t.styles&&(n+=t.styles),n+="}</style>",l._styles.html(l._styles.html()+n)},doScroll:function(e){var t=e.offset().top;document.body.scrollTop=t;var n=e[0].getBoundingClientRect(),o=l._box[0].getBoundingClientRect();n.height+o.height<window.innerHeight&&(t-=(o.top-n.height)/2,document.body.scrollTop=t)},positionBlockouts:function(e){if(e){var t=e[0].getBoundingClientRect(),n=t.left,o=t.top;e.outerHeight()+o,e.outerWidth()+n;l._top.css({width:t.width,height:t.top,left:t.left,top:o-t.top}),l._bottom.css({width:t.width,height:window.innerHeight-(t.top+t.height),left:t.left,top:t.top+t.height}),l._left.css({width:t.left,height:"100%",left:0,top:0}),l._right.css({width:window.innerWidth-(t.width+t.left),height:"100%",right:0,top:0})}else l._top.css({width:"100%",height:"100%",left:0,top:0}),l._right.css({width:0,height:0,right:0,top:0}),l._left.css({width:0,height:0,left:0,top:0}),l._bottom.css({width:0,height:0,left:0,top:0})},run_steps:function(){l._styles.html(""),angular.element(document.querySelector(".walkthru_item")).removeClass("walkthru_item"),angular.element(document.querySelector(".walkthru_item_parent")).removeClass("walkthru_item_parent");var e=document.getElementById("walkthru_box_next");e.addEventListener("click",l.next,!0);var t=document.getElementById("walkthru_box_prev");t.addEventListener("click",l.prev,!0);var n=document.getElementById("walkthru_box_done");n.addEventListener("click",l.done,!0),l.steps.initial&&"function"==typeof l.steps.initial?(l.steps.initial(),l.runner()):l.runner()},refreshStep:function(e){if(angular.element(document.querySelector(".walkthru_item")).removeClass("walkthru_item"),angular.element(document.querySelector(".walkthru_item_parent")).removeClass("walkthru_item_parent"),l.steps[l.index].element){var n=angular.element(document.querySelectorAll(l.steps[l.index].element));if(0===n.length)t(function(){l.runner()},500);else{var i=angular.element(n[0]);l.doScroll(i),i.addClass("walkthru_item"),i.attr("id",i.attr("id")||o(10)),l.makeStyles(i,l.steps[l.index]),l.positionBlockouts(i),l.cycleParents(i[0])}}else l.positionBlockouts(i)},runner:function(){if(l.steps[l.index])if(l._styles.html(""),angular.element(document.querySelector(".walkthru_item")).removeClass("walkthru_item"),angular.element(document.querySelector(".walkthru_item_parent")).removeClass("walkthru_item_parent"),l.steps[l.index].func&&"function"==typeof l.steps[l.index].func&&l.steps[l.index].func(function(e){}),l._text.text(l.steps[l.index].text),l.steps[l.index].element){var e=angular.element(document.querySelectorAll(l.steps[l.index].element));if(0===e.length)t(function(){l.runner()},500);else{var n=angular.element(e[0]);l.doScroll(n),n.addClass("walkthru_item"),n.attr("id",n.attr("id")||o(10)),l.makeStyles(n,l.steps[l.index]),l.positionBlockouts(n),l.cycleParents(n[0])}}else l.positionBlockouts(n);else l.steps.complete&&"function"==typeof l.steps.complete&&l.steps.complete(function(e){})},next:function(){l.index=l.index+1,l.runner()},prev:function(){l.index=l.index-1,l.runner()},done:function(){l.index=0,t(function(){l.steps=null,l.active=!1,l._wrapper.remove(),l._styles.html(""),angular.element(document.querySelector(".walkthru_item")).removeClass("walkthru_item"),angular.element(document.querySelector(".walkthru_item_parent")).removeClass("walkthru_item_parent"),l.doneFunc&&"function"==typeof l.doneFunc&&l.doneFunc()})},run:function(e){l.steps=e,e.hasOwnProperty("doneFunc")&&"function"==typeof e.doneFunc&&(l.doneFunc=e.doneFunc),l.index=0,l.dom_it().then(function(){l.run_steps()})}};return l}])}(angular.module("eduCKate"));
//# sourceMappingURL=educkate.min.js.map